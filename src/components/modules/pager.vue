<template>
  <section>
    <div v-if="isMobile" class="footer-page" :class="{fixed: fixed}">
      <el-button  size="mini" :disabled="currentPage <= 1" @click="pre()">上一页</el-button>
      <el-button  size="mini" @click="backTop()">返回首页</el-button>
      <el-button  size="mini" :disabled="currentPage >= Math.ceil(total / pageSize)" @click="next()">下一页</el-button>
    </div>
    <el-pagination
      v-else
      background
      :attr="$attrs"
      v-on="$listeners"
      :total="total"
      :page-size="pageSize"
      :current-page="currentPage"
      :page-sizes="sizes"
      class="footer-pc-page"
      layout="total, sizes, prev, pager, next, jumper"
      >
    </el-pagination>
  </section>
</template>

<script>
export default {
  name: 'pager',
  data () {
    return {
      isMobile: false
    }
  },
  props: {
    currentPage: {
      type: Number,
      default () { return 1 }
    },
    total: {
      type: Number,
      default () { return 0 }
    },
    pageSize: {
      type: Number,
      default () { return 10 }
    },
    pageSizes: {
      type: Array,
      required: true,
      default () { return [10, 20, 50] }
    },
    fatherId: {
      type: String,
      default () { return null }
    },
    fixed: {
      type: Boolean,
      default () { return false }
    }
  },
  methods: {
    pre (){
      if (this.currentPage <= 1) return
      this.$emit('current-change', this.currentPage - 1)
      this.scrollTop()
    },
    next (){
      if (this.currentPage >= Math.ceil(this.total / this.pageSize) ) return
      this.$emit('current-change', this.currentPage + 1)
      this.scrollTop()
    },
    backTop () {
      this.$emit('current-change', 1)
      this.scrollTop()
    },
    scrollTop () {
      let currentScroll = document.documentElement.scrollTop || document.body.scrollTop;
      (function scroll(){
        let currentScroll = document.documentElement.scrollTop || document.body.scrollTop;
        if (currentScroll > 0) {
          window.requestAnimationFrame(scroll);
          window.scrollTo (0,currentScroll - (currentScroll / 5));
        }
      })();
    }
  },
  components: {
  },
  mounted () {
    if (document.body.clientWidth < 600) {
      this.isMobile = true
      this.$forceUpdate()
    }
    window.onresize = () => {
      if (document.body.clientWidth < 600) {
        this.isMobile = true
        this.$forceUpdate()
      }
    }
  }
}
</script>

<style scoped lang="scss">
  .fixed{
    position: fixed!important;
  }
  .footer-page{
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    background-color: #fff;
    padding: 5px 5px;
    display: flex;
    justify-content: space-around;
    z-index: 1;
  }
  .footer-pc-page{
    position: absolute;
    bottom: 0;
    left: 50%;
    width: auto;
    transform: translate(-50%,0);
    background-color: #fff;
    padding: 5px 5px;
    float:  right;
    z-index: 1;
  }
</style>
